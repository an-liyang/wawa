<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>抓娃娃大战</title>
    <link rel="stylesheet" href="../css/demo.css">
    <link rel="stylesheet" href="../css/loaders.css">
    <link rel="stylesheet" href="../css/animate.css">
    <link rel="stylesheet" href="../css/common.css">
    <script src="../js/jquery.js"></script>
</head>
<body>
    <div class="mian">
      <div class="content">
        <!--爪子-->
        <div id="zhuzi">
          <div id="line"></div>
        </div>
        <div id="start">开始</div>
        <div id="down">向下</div>
        <!--出口-->
        <div id="chukou">出口</div>
        <!--娃娃-->
        <div id="graoup_wawa"></div>
      </div>
    </div>
   
</body>
<script>
    window.onload=window.onresize=function(){
        document.documentElement.style.fontSize = document.documentElement.clientWidth / 7.5 + 'px';
    };
  $(function () {
      var css = {'left':'5.3rem'};
      var hTop = {"top":'6.2rem'};
      var timer = 0;
      
//      y轴防止重复点击
      var Y_flag = false;
//      x轴防止重复点击
      var X_flag = false;
//      记录开始的时间
      var count_timer = function(){
//          x轴返回时间
           set_time=setInterval(function () {
                  timer+=200;
              },200);
          return set_time
      }
      $('#start').click(function () {
          if(!X_flag){
              X_flag =true;
              count_timer();
              $("#zhuzi").animate(css,5000,rowBack);
          }else {
              return '';
          }
          
      })
//      左右
      function rowBack(){
          if(css.left=='0.8rem')
              css.left='5.3rem';
          else if(css.left=='5.3rem')
              css.left='0.8rem';
          console.log(css);
          $('#zhuzi').animate(css,5000,rowBack);
      }
//      向下
      function colBack() {
          var _left = $("#zhuzi").position().left;
          console.log(timer,_left);
          sheng_cheng(_left);
          $("#zhuzi").animate({'top':'2.6rem'},2000,function () {
              $("#zhuzi").animate({'left':'0.8rem'},timer,function () {
//                  确定返回动画完成重置参数
                  timer = 0;
                  X_flag = false;
                  Y_flag = false;
              })
          })
      }
      $('#down').click(function () {
          
          if(Y_flag){
              return '';
          }else {
              Y_flag = true;
              clearInterval(set_time);
              var flag = 0;
              flag = Math.floor(timer/5000);
//          最终返回x轴时间确定
              if(flag%2 == 0){
                  timer -=5000*flag;
              }else {
                  timer=5000*(flag+1) - timer;
              }
//          阻止x轴动画停止
              console.log(timer);
              $("#zhuzi").stop();
              console.log($("#zhuzi").position().top);
              $("#zhuzi").animate(hTop,2000,colBack)
              $("#line").animate({'height':'2.7rem'},2000,function () {
                  $("#line").animate({'height':'0'},2000)
              })
          }
          
      });
//      娃娃概率
      function random0() {
          console.log("再接再厉");
      }
      function random1() {
          var ran1=Math.floor(Math.random()*10+1);
          console.log("恭喜抓住普通娃娃");
      }
      function random2() {
          var ran2=Math.floor(Math.random()*100+1);
          if(ran2>=1 && ran2<=20 ){
              console.log("恭喜抓住稀有娃娃");
          }else{
              console.log("恭喜抓住普通娃娃");
          }
      }
      function random3() {
          var ran3=Math.floor(Math.random()*100+1);
          if(ran3<=10 ){
              console.log("恭喜抓住史诗娃娃");
          }else if(ran3>=11 && ran3<=50){
              console.log("恭喜抓住稀有娃娃");
          }else if(ran3>=51){
              console.log("恭喜抓住普通娃娃");
          }
      }
      function random4() {
          var ran4=Math.floor(Math.random()*100+1);
          if(ran4<=5 ){
              console.log("恭喜抓住传说娃娃");
          }else if(ran4>=6 && ran4<=25){
              console.log("恭喜抓住史诗娃娃");
          }else if(ran4>=26 && ran4<=75){
              console.log("恭喜抓住稀有娃娃");
          }else{
              console.log("恭喜抓住普通娃娃");
          }
      }
      function random5() {
          var ran5=Math.floor(Math.random()*100+1);
          if(ran5<=10 ){
              console.log("恭喜抓住传说娃娃");
          }else if(ran5>=11 && ran5<=50){
              console.log("恭喜抓住史诗娃娃");
          }else if(ran5>=51){
              console.log("恭喜抓住稀有娃娃");
          }
      }
//      娃娃生成
      function sheng_cheng(left) {
          if(left<100){
              random0();
          }else if(left>=100 && left<141){
              random1();
          }else if(left<182 && left>=141){
              random2();
          }else if(left<223 && left>=182){
              random3();
          }else if(left<248 && left>=223){
              random4();
          }else{
              random5();
          }
      }
      
  })
</script>
</html>